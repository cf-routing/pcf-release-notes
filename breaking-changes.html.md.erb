---
title: PCF v2.6 Breaking Changes
owner: Release Engineering
---

This topic describes the breaking changes you need to be aware of when upgrading to Pivotal Cloud Foundry (PCF) v2.6. For more information about important preparation steps you must follow before beginning an upgrade, see [Upgrading Pivotal Cloud Foundry](https://docs.pivotal.io/pivotalcf/2-6/customizing/upgrading-pcf.html).


## <a id='opsman'></a> PCF Ops Manager

See the following Ops Manager breaking changes:

### <a id="cflinuxfs2-unsupported"></a> cflinuxfs2 is Unsupported

Operators cannot upgrade the platform from PAS v2.5.10 or later to PAS v2.6 until all app instances (AIs) are using cflinuxfs3.
If you are running PAS v2.5.10 or a later v2.5 patch, you must migrate all AIs to cflinuxfs3.

During upgrade, you must check a box to verify that all AIs have been migrated. If you check the box and the AIs have not been migrated, the upgrade causes all AIs to fail.

<%= vars.recommended_by %> recommends that you communicate the change of stack to your development teams and have them migrate to cflinuxfs3 before upgrading to PAS v2.6.

For more information about this change, see [PAS Only Supports cflinuxfs3](https://docs.pivotal.io/pivotalcf/2-5/pcf-release-notes/runtime-rn.html#cflinuxfs3) in _Pivotal Application Service v2.5 Release Notes_.

### <a id='ssh-private-key'></a> Passwords Not Supported for Ops Manager VM on vSphere

You can only SSH onto the Ops Manager VM in a vSphere deployment with a private SSH key. You cannot SSH onto the Ops Manager VM with a password.

To avoid upgrade failure and errors when authenticating, add a public key to the OVF template for the Ops Manager VM. Then, use the private key to SSH onto the Ops Manager VM.

For more information about adding a public key to the OVF template, see [Deploy Ops Manager](https://docs.pivotal.io/pivotalcf/2-6/om/vsphere/deploy.html#deploy) in _Deploying Ops Manager on vSphere_.

<p class="note warning"><strong>Warning:</strong> You cannot upgrade successfully without adding a public key. If you do not add a key, Ops Manager shuts down automatically because it cannot find a key and may enter a reboot loop.</p>

### <a id='diagnostic-report-stemcell'></a> Stemcell Property for Diagnostic Report API Endpoint is Removed

The `stemcell` property for the `/api/v0/diagnostic_report` endpoint is removed. Update any automation that uses the stemcell information in the `/api/v0/diagnostic_report` endpoint to avoid errors.

Information about all stemcells for both staged and deployed products is listed under a new `added_products` property for the `/api/v0/diagnostic_report` endpoint. Stemcell information under the `added_products` property includes the stemcell filename, OS, and version.

For more information about the `/api/v0/diagnostic_report` endpoint, see [Diagnostic Report](https://docs.pivotal.io/pivotalcf/2-6/opsman-api/#diagnostic-report) in the Ops Manager API documentation.

### <a id='stemcell-version-key'></a> Stemcell Version Key for Pending Changes is Moved and Renamed

For the `/api/v0/staged/pending_changes` endpoint, the `stemcell_version` key from previous versions of the Ops Manager API is now the `version` sub-key under the `stemcells` key.

Update any automation that uses the stemcell information in the `/api/v0/pending_changes` endpoint to avoid errors.

For more information about the `/api/v0/staged/pending_changes` endpoint, see [View a list of pending changes](https://docs.pivotal.io/pivotalcf/2-6/opsman-api/#view-a-list-of-pending-changes) in the Ops Manager API documentation.

### <a id='5th-gen-instances'></a> AWS Deployments Use 5th Generation Instances

Ops Manager v2.6 uses the latest generation of instances for AWS deployments. When you upgrade to Ops Manager v2.6, your VM types convert to the corresponding 5th generation instance types, such as `t2` to `t3` and `c4` to `c5`.

If you are using a custom instance type catalog, your VM types that are used and available do not change.

These instance types are supported by Xenial stemcells and Trusty stemcell 3586 and later. Stemcells earlier than Trusty stemcell 3586 fail to boot Ops Manager. To avoid this, ensure that you are using Trusty stemcell 3586 or later.

For more information about AWS instance types, see [Amazon EC2 Instance Types](https://aws.amazon.com/ec2/instance-types/) in the AWS documentation.

### <a id='renamed-stemcell-endpoint'></a> Stemcell Assignments Endpoint Deprecated

The `stemcells_assignments` endpoint in the Ops Manager API has been deprecated. The deprecated endpoint only returns a single stemcell for a product.

Instead, operators should use the `stemcell_associations` endpoint, which returns information about all stemcells associated with a product.

For more information, see [Stemcell Associations for Products](https://docs.pivotal.io/pivotalcf/2-6/opsman-api/#stemcell-associations-for-products) in the Ops Manager API documentation.


## <a id='pas'></a> Pivotal Application Service (PAS)

See the following PAS breaking changes:

### <a id='http-healtcheck'></a> HTTP Health Check Server Disabled for SSH Proxy

If your SSH load balancer is configured with an HTTP health check, remove the healthcheck before upgrading. This is the load balancer specified in the **Diego Brain** row of the **Resource Config** pane.

<p class="note"><strong>Note:</strong> Neither the Terraform templates for installing PAS nor the PAS installation instructions specify a HTTP healthcheck for the SSH Load balancer.</p>

The `ssh_proxy` job running on the Diego Brain VM no longer starts a HTTP health check server. This feature was previously added to allow GCP load balancers to health check the service. However, GCP load balancers no longer require an HTTP endpoint for health checks.

Additionally, making this healthcheck server inaccessible improves the security of the platform.

### <a id='router-cpus'></a> Default VM Type Change for Gorouter VMs

PAS v2.6 increases the default and minimum CPU core count from one to two for Gorouter VMs.

Verify that you have sufficient infrastructure resources allocated to the deployment before upgrading to PAS v2.6.

### <a id='nfs-legacy-compatibility'></a> Root UID and GID No Longer Allowed in NFS Volume Service Bindings

In PAS v2.6, the NFS-Legacy Mounter is removed. Migrating to the NFS volume service may be required if `nfs-legacy` services are bound with a `uid` or `gid` set to `0` or root. NFS Volume service does not allow specifying `uid=0` or `gid=0` as bind options.

For more information on how to migrate apps from `nfs-legacy` to `nfs`, see [Upgrade Preparation Checklist for PCF v2.6](https://docs.pivotal.io/pivotalcf/2-6/upgrading/checklist.html).

### <a id="check-mysql-ram"></a> New Internal MySQL Buffer Pool Size In PAS v2.6.8 and Later

In PAS v2.6.8 and later, the buffer pool size for the internal MySQL database is changed from 2&nbsp;GB to 50% of available memory.

You may need to choose a VM type with a larger amount of RAM to avoid Out of Memory (OOM) errors.

For example, in PAS v2.6.7 and earlier, if the internal MySQL VM is
configured with 8&nbsp;GB of RAM and 6&nbsp;GB is currently used,
then 2&nbsp;GB is consumed by the buffer pool and 4&nbsp;GB is consumed by everything else.

In this example, upgrading to PAS v2.6.8 causes OOM errors because the
buffer pool consumes 4&nbsp;GB, which leaves 0&nbsp;GB of available RAM.


## <a id='pas-windows'></a> Pivotal Application Service for Windows (PASW)

See the following PASW breaking changes:

* The **Use "cf" as deployment name in emitted metrics instead of unique name** option is removed from the **Adavanced Features** pane of the PASW tile.

* Windows stemcell v2019.2 is not compatible with Ops Manager v2.6. Before upgrading to Ops Manager v2.6, upgrade your Windows stemcell to v2019.3 or later.
